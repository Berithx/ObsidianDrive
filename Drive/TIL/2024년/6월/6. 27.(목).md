```table-of-contents
title: 
style: nestedList # TOC style (nestedList|inlineFirstLevel)
minLevel: 0 # Include headings from the specified level
maxLevel: 0 # Include headings up to the specified level
includeLinks: true # Make headings clickable
debugInConsole: false # Print debug info in Obsidian console
```

# 1. Spring
## ■ JPA N+1 문제

### - N+1 문제란?
연관 관계가 설정된 엔티티를 조회할 경우 조회된 데이터 갯수(n)만큼 연관관계의 조회 쿼리가 추가로 발생하여 데이터를 읽어오는 현상

### - 원인
- JpaRepository에 정의된 메서드를 호출하면 JPA는 메서드의 이름을 분석하여 JPQL을 생성하고 이를 실행한다.
- JPQL은 SQL을 추상화한 객체지향 쿼리 언어로서 특정 SQL에 종속되지 않은 상태에서 엔티티 객체와 필드 이름을 가지고 쿼리를 진행한다.
- DB을 읽는 메서드를 통해 JPA는 생성된 JPQL을 통해 대상이 되는 객체 정보가 담긴 Row를 조회한다.
- 그랬을 때 해당 객체가 1:N관계 또는 N:1 관계라면 JPQL은 연관관계를 무시한 상태에서 조회한다.
- 만약 조회한 객체에 연관된 Entity의 데이터가 필요한 경우 JPA는 FetchType으로 설정한 시점에 조회를 추가적으로 진행한다. 이 경우 발생하는 문제가 N+1 문제이다.

### - 해결 방법
- Fetch Join
	- 의도 : JPQL을 사용하여 DB에서 데이터를 가져올 때 처음부터 연관된 데이터까지 같이 가져는 방법(SQL에서의 Join문과 비슷하다.)
	- 이를 위해서는 JpaRepository를 구현하는 구현체에 별도의 메서드를 
- @EntityGraph
- Batch Size
- @Fetch(FetchMode.SUBSELECT)




[[Templates]]
